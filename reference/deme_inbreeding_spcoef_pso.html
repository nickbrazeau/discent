<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Identify Deme Inbreeding Spatial Coefficients in Continuous Space with Particle Swarm Meta-Optimization — deme_inbreeding_spcoef_pso • discent</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Identify Deme Inbreeding Spatial Coefficients in Continuous Space with Particle Swarm Meta-Optimization — deme_inbreeding_spcoef_pso"><meta property="og:description" content="The Particle Swarm Optimization (PSO) is a meta-optimization (meta-heuristic) approach that attempts to find optimal
start parameters for the user to avoid a grid-search approach as would be best practices for fine-tuning the gradient descent
approach."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">discent</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/runmod.html">Running the Model</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/nickbrazeau/discent" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify Deme Inbreeding Spatial Coefficients in Continuous Space with Particle Swarm Meta-Optimization</h1>

    <div class="hidden name"><code>deme_inbreeding_spcoef_pso.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The Particle Swarm Optimization (PSO) is a meta-optimization (meta-heuristic) approach that attempts to find optimal
start parameters for the user to avoid a grid-search approach as would be best practices for fine-tuning the gradient descent
approach.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">deme_inbreeding_spcoef_pso</span><span class="op">(</span></span>
<span>  <span class="va">discdat</span>,</span>
<span>  m_lowerbound <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  m_upperbound <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  fi_lowerinit <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  fi_upperinit <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  flearn_lowerinit <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  flearn_upperinit <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  mlearn_lowerinit <span class="op">=</span> <span class="fl">1e-15</span>,</span>
<span>  mlearn_upperinit <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  c1 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  c2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  w <span class="op">=</span> <span class="fl">0.73</span>,</span>
<span>  b1 <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  b2 <span class="op">=</span> <span class="fl">0.999</span>,</span>
<span>  e <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  finalsteps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  particlesteps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  swarmmoves <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  swarmsize <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  normalize_geodist <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  report_sd_progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  report_fd_progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-discdat">discdat<a class="anchor" aria-label="anchor" href="#arg-discdat"></a></dt>
<dd><p>dataframe; The genetic-geographic data by deme (K)</p></dd>


<dt id="arg-m-lowerbound">m_lowerbound<a class="anchor" aria-label="anchor" href="#arg-m-lowerbound"></a></dt>
<dd><p>double; lower limit value for the global "m" parameter; any "m" value encounter less than the lower bound will be replaced by the lower bound</p></dd>


<dt id="arg-m-upperbound">m_upperbound<a class="anchor" aria-label="anchor" href="#arg-m-upperbound"></a></dt>
<dd><p>double; upper limit value for the global "m" parameter; any "m" value encounter greater than the upper bound will be replaced by the upper bound</p></dd>


<dt id="arg-fi-lowerinit">fi_lowerinit<a class="anchor" aria-label="anchor" href="#arg-fi-lowerinit"></a></dt>
<dd><p>double; The initial deme-inbreeding parameter lower-bound to parameterize
each swarm-particle (\(a\)), such that starting deme-inbreeding estimates are drawn from
a uniform distribution \(f = U_{a,b} \)</p></dd>


<dt id="arg-fi-upperinit">fi_upperinit<a class="anchor" aria-label="anchor" href="#arg-fi-upperinit"></a></dt>
<dd><p>double; As above, the initial deme-inbreeding parameter upper-bound to parameterize
each swarm-particle (\(b\)).</p></dd>


<dt id="arg-flearn-lowerinit">flearn_lowerinit<a class="anchor" aria-label="anchor" href="#arg-flearn-lowerinit"></a></dt>
<dd><p>double; The initial deme-inbreeding learning-rate lower-bound to parameterize
each swarm-particle's convergence to the \(f\) parameter (\(a\) draw from the unifrom \(f = U_{a,b} \)).</p></dd>


<dt id="arg-flearn-upperinit">flearn_upperinit<a class="anchor" aria-label="anchor" href="#arg-flearn-upperinit"></a></dt>
<dd><p>double; As above, the initial deme-inbreeding learning-rate upper-bound to parameterize
each swarm-particle (\(b\)).</p></dd>


<dt id="arg-mlearn-lowerinit">mlearn_lowerinit<a class="anchor" aria-label="anchor" href="#arg-mlearn-lowerinit"></a></dt>
<dd><p>double; similar to before, the initial migration learning-rate lower-bound to parameterize
each swarm-particle's convergence to the \(m\) parameter (\(a\) draw from the unifrom \(m = U_{a,b} \)).</p></dd>


<dt id="arg-mlearn-upperinit">mlearn_upperinit<a class="anchor" aria-label="anchor" href="#arg-mlearn-upperinit"></a></dt>
<dd><p>double; As above, the initial migration learning-rate upper-bound to parameterize
each swarm-particle (\(b\)).</p></dd>


<dt id="arg-c-">c1<a class="anchor" aria-label="anchor" href="#arg-c-"></a></dt>
<dd><p>double; the "cognitive" coefficient from the PSO algorithm. Essentially, it
dictates how strongly the prior particle's positions should be weighted
against the entire swarm's historical positions in determining the next step of exploration.</p></dd>


<dt id="arg-c-">c2<a class="anchor" aria-label="anchor" href="#arg-c-"></a></dt>
<dd><p>double; the "social" coefficient from the PSO. Essentially determines how much weight
or influence other particles in the swarm exert on the current particle in determing the next step
of exploration.</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>double; the "inertia" coefficient from the PSO algorithm. Essentially, how
strongly the currently velocity (i.e. the direction the particle is headed) should be weighted relative to the prior particle's
and swarm's current positions (i.e. prior directions).</p></dd>


<dt id="arg-b-">b1<a class="anchor" aria-label="anchor" href="#arg-b-"></a></dt>
<dd><p>double; exponential decay rates for the first moment estimate in the Adam optimization algorithm</p></dd>


<dt id="arg-b-">b2<a class="anchor" aria-label="anchor" href="#arg-b-"></a></dt>
<dd><p>double; exponential decay rates for the second moment estimate in the Adam optimization algorithm</p></dd>


<dt id="arg-e">e<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>double; epsilon (error) for stability in the Adam optimization algorithm</p></dd>


<dt id="arg-finalsteps">finalsteps<a class="anchor" aria-label="anchor" href="#arg-finalsteps"></a></dt>
<dd><p>integer; the number of "final" steps considered for the "final run" of the gradient descent</p></dd>


<dt id="arg-particlesteps">particlesteps<a class="anchor" aria-label="anchor" href="#arg-particlesteps"></a></dt>
<dd><p>integer; the number of steps that a particle takes in the vanilla gradient descent algorithm given its newly initialized start parameters in
order to calculate a cost for the new position. Essentially, we consider the vanilla gradient descent model at the current position for a short number of iterations to
estimate the "favorability of the positions current footing" or "traction" of the current position being considered.</p></dd>


<dt id="arg-swarmmoves">swarmmoves<a class="anchor" aria-label="anchor" href="#arg-swarmmoves"></a></dt>
<dd><p>integer; the number of iterations or moves that the particles within the swarm are able
to explore before selecting the final particle for the "final" run (note, <em>moves</em> is reserved for the swarm's actions, while <em>steps</em>
is used to describe iterations in the gradient descent algorithm).</p></dd>


<dt id="arg-swarmsize">swarmsize<a class="anchor" aria-label="anchor" href="#arg-swarmsize"></a></dt>
<dd><p>integer; the number of particles in the swarm</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>integer; the number of steps to keep as part of the output (i.e. if the user specifies 10, every 10th iteration will be kept)</p></dd>


<dt id="arg-normalize-geodist">normalize_geodist<a class="anchor" aria-label="anchor" href="#arg-normalize-geodist"></a></dt>
<dd><p>boolean; whether geographic distances between demes should be normalized (i.e. Min-Max Feature Scaling: \(X' = \frac{X - X_{min}}{X_{max} - X_{min}} \), which places the geodistances on the scale to \([0-1]\)). Helps increase model stability at the expense of complicating the interpretation of the migration rate parameter.</p></dd>


<dt id="arg-report-sd-progress">report_sd_progress<a class="anchor" aria-label="anchor" href="#arg-report-sd-progress"></a></dt>
<dd><p>boolean; search chain</p></dd>


<dt id="arg-report-fd-progress">report_fd_progress<a class="anchor" aria-label="anchor" href="#arg-report-fd-progress"></a></dt>
<dd><p>boolean; final chain</p></dd>


<dt id="arg-return-verbose">return_verbose<a class="anchor" aria-label="anchor" href="#arg-return-verbose"></a></dt>
<dd><p>boolean; whether the inbreeding coefficients and migration rate should be returned for every iteration or
only for the final iteration. User will typically not want to store every iteration, which can be memory intensive</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Default values are based on ***</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Clerc, M., and J. Kennedy. The Particle Swarm — Explosion, Stability, and Convergence in a Multidimensional Complex Space. IEEE Transactions on Evolutionary Computation 6, no. 1 (February 2002): 58–73. Y. H. Shi and R. C. Eberhart, “A modified particle swarm optimizer,” in Proceedings of the IEEE International Conferences on Evolutionary Computation, pp. 69–73, Anchorage, Alaska, USA, May 1998.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nick Brazeau, Bob Verity.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

