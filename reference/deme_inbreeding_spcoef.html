<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Identify Deme Inbreeding Spatial Coefficients in Continuous Space — deme_inbreeding_spcoef • discent</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Identify Deme Inbreeding Spatial Coefficients in Continuous Space — deme_inbreeding_spcoef"><meta property="og:description" content="The purpose of this statistic is to identify an inbreeding coefficient, or degree of
relatedness, for a given location in space. We assume that locations in spaces can be
represented as &quot;demes,&quot; such that multiple individuals live in the same deme
(i.e. samples are sourced from the same location). The expected pairwise relationship
between two individuals, or samples, is dependent on the each sample's deme's inbreeding
coefficient and the geographic distance between the demes. The program assumes a symmetric distance matrix."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">discent</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/runmod.html">Running the Model</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/nickbrazeau/discent" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify Deme Inbreeding Spatial Coefficients in Continuous Space</h1>
    
    <div class="hidden name"><code>deme_inbreeding_spcoef.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The purpose of this statistic is to identify an inbreeding coefficient, or degree of
relatedness, for a given location in space. We assume that locations in spaces can be
represented as "demes," such that multiple individuals live in the same deme
(i.e. samples are sourced from the same location). The expected pairwise relationship
between two individuals, or samples, is dependent on the each sample's deme's inbreeding
coefficient and the geographic distance between the demes. The program assumes a symmetric distance matrix.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">deme_inbreeding_spcoef</span><span class="op">(</span></span>
<span>  <span class="va">discdat</span>,</span>
<span>  start_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  f_learningrate <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  m_learningrate <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  momentum <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  steps <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  report_progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>discdat</dt>
<dd><p>dataframe; The genetic-geographic data by deme (K)</p></dd>


<dt>start_params</dt>
<dd><p>named double vector; vector of start parameters.</p></dd>


<dt>f_learningrate</dt>
<dd><p>double; alpha parameter for how much each "step" is weighted in the gradient descent for inbreeding coefficients</p></dd>


<dt>m_learningrate</dt>
<dd><p>double; alpha parameter for how much each "step" is weighted in the gradient descent for the migration parameter</p></dd>


<dt>momentum</dt>
<dd><p>double; gamma parameter for momentum for adaptive learning rate</p></dd>


<dt>steps</dt>
<dd><p>integer; the number of "steps" as we move down the gradient</p></dd>


<dt>report_progress</dt>
<dd><p>boolean; whether or not a progress bar should be shown as you iterate through steps</p></dd>


<dt>return_verbose</dt>
<dd><p>boolean; whether the inbreeding coefficients and migration rate should be returned for every iteration or
only for the final iteration. User will typically not want to store every iteration, which can be memory intensive</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The gen.geo.dist dataframe must be named with the following columns:
"smpl1"; "smpl2"; "deme1"; "deme2"; "gendist"; "geodist"; which corresponds to:
Sample 1 Name; Sample 2 Name; Sample 1 Location; Sample 2 Location;
Pairwise Genetic Distance; Pairwise Geographpic Distance. Note, the order of the
columns do not matter but the names of the columns must match.</p>
<p>The start_params vector names must match the cluster names (i.e. clusters must be
have a name that we can match on for the starting relatedness paramerts). In addition,
you must provide a start parameter for "m".</p>
<p>Note: We have implemented coding decisions to not allow the "f" inbreeding coefficients to be negative by using a
logit transformation internally in the code. Similarly, the "m" global migration rate cannot be negative and is bounded to be positive by
through taking the absolute value in every iteration.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nick Brazeau, Bob Verity.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

